<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized dose-escalation safety schematics via Complete Path Enumeration (CPE) • precautionary</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generalized dose-escalation safety schematics via Complete Path Enumeration (CPE)">
<meta property="og:description" content="precautionary">
<meta property="og:image" content="https://github.com/dcnorris/precautionary/raw/main/docs/card.png">
<meta property="og:image:alt" content="Logo for precautionary package">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@davidcnorrismd">
<meta name="twitter:site" content="@davidcnorrismd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">precautionary</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.6-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DTP-vs-Korn94.html">DTP-vs-Korn94</a>
    </li>
    <li>
      <a href="../articles/FDA-proactive.html">How FDA can vet dose-escalation trials for safety</a>
    </li>
    <li>
      <a href="../articles/Intro.html">Introduction to package 'precautionary'</a>
    </li>
    <li>
      <a href="../articles/MCSE-Free.html">MCSE-Free CRM Performance and Safety Assessment</a>
    </li>
    <li>
      <a href="../articles/Safety-Schematic-via-CPE.html">Generalized dose-escalation safety schematics via Complete Path Enumeration (CPE)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcnorris/precautionary/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Safety-Schematic-via-CPE_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generalized dose-escalation safety schematics via Complete Path Enumeration (CPE)</h1>
                        <h4 data-toc-skip class="author">David C. Norris</h4>
            
            <h4 data-toc-skip class="date">1/12/2021; revised 4/02/2021; revised again 6/14/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dcnorris/precautionary/blob/HEAD/vignettes/Safety-Schematic-via-CPE.Rmd" class="external-link"><code>vignettes/Safety-Schematic-via-CPE.Rmd</code></a></small>
      <div class="hidden name"><code>Safety-Schematic-via-CPE.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="aims">Aims<a class="anchor" aria-label="anchor" href="#aims"></a>
</h2>
<p><span class="citation">Norris (2020b)</span> proposed a universal schematic for evaluating the safety of the 3+3 dose-escalation design, and conjectured that the <em>dose transition pathways</em> (DTP) of <span class="citation">Yap et al. (2017)</span> would enable a similar treatment of model-based designs. This vignette demonstrates the fulfillment of that promise, in a demonstration of <em>complete path enumeration</em> (CPE) implemented efficiently for the continual reassessment method (CRM).</p>
</div>
<div class="section level2">
<h2 id="generalized-exact-simulation-of-dose-escalation">Generalized exact simulation of dose escalation<a class="anchor" aria-label="anchor" href="#generalized-exact-simulation-of-dose-escalation"></a>
</h2>
<p>Dose-escalation trial designs commonly operate with a fixed set of <span class="math inline">\(D\)</span> prespecified doses, enrolling participants in small cohorts each of size <span class="math inline">\(n\)</span>, at doses selected sequentially according to observed counts of binary dose-limiting toxicities (DLTs). Under such designs, the observations at any point in the trial may be recorded in a <span class="math inline">\(C \times D\)</span> matrix of toxicity counts <span class="math inline">\(\{0, 1, ..., n, -\}\)</span>, with ‘<span class="math inline">\(-\)</span>’ being used where a cohort has not been enrolled. Indeed, for deterministic designs in which dose-escalation decisions depend strictly on the history of observed DLT counts, such matrices suffice to account for the full dose-escalation sequence.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> For designs with upper bounds on enrollment, <span class="math inline">\(C\)</span> may be fixed <em>ex ante</em>, and all possible paths comprehensively enumerated.</p>
<p>In <span class="citation">Norris (2020b)</span>, for example, paths through the 3+3 design could be represented as <span class="math inline">\(2 \times D\)</span> matrices because the 3+3 design enrolls at most 2 cohorts at any given dose. The mathematical treatment offered there for the path matrices <span class="math inline">\(T_{c,d}^j\)</span> was independent of the 3+3 rules, however, and carries forward generally:</p>
<p>Denoting the prespecified doses by <span class="math inline">\((X_d)\)</span> and the cumulative distribution function of <span class="math inline">\(\mathrm{MTD}_i\)</span> by <span class="math inline">\(P\)</span>, we can write the vector <span class="math inline">\((\pi^j)\)</span> of path probabilities:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p><span class="math display">\[
\begin{align}
p_d &amp;= P(\mathrm{MTD}_i&lt; X_d)\quad\mbox{(dose-wise toxicity probabilities)}\\
q_d &amp;= 1 - p_d\\
\pi^j &amp;= \prod_{c,d} {n \choose T_{c,d}^j} p_d^{T_{c,d}^j} q_d^{(n-T_{c,d}^j)}\quad\mbox{(path probabilities)} (\#eq:pi)
\end{align}
\]</span></p>
<p>Again as in <span class="citation">Norris (2020b)</span>, taking logs in @ref(eq:pi) we find:</p>
<p><span class="math display">\[
\log \boldsymbol{\pi} = \sum_{c,d} \log {n \choose T_{c,d}} + \sum_c [T_{c,d},n-T_{c,d}]\left[{ \log \mathbf{p} \atop \log \mathbf{q}} \right] = \mathbf{b} + \mathrm{U}\left[{ \log \mathbf{p} \atop \log \mathbf{q}} \right], (\#eq:log-pi)
\]</span> where the <span class="math inline">\(J \times 2D\)</span> matrix <span class="math inline">\(U\)</span> and the <span class="math inline">\(J\)</span>-vector <span class="math inline">\(\mathbf{b}\)</span> are characteristic <em>constants</em> of the given dose-escalation design.</p>
<p>Finally, we may as previously introduce the log-therapeutic index <span class="math inline">\(\kappa\)</span>, enabling us to write the fatal (grade-5) fraction <span class="math inline">\(f_d\)</span> of DLTs as:</p>
<p><span class="math display">\[
f_d = \frac{P(e^{2\kappa} \mathrm{MTD}_i&lt;  X_d)}{P(\mathrm{MTD}_i&lt; X_d)}, (\#eq:fatal-fraction)
\]</span></p>
<p>in terms of which the expected number of fatal toxicities is:</p>
<p><span class="math display">\[
\boldsymbol{\pi}^\intercal \mathrm{Y} \mathbf{f},  (\#eq:fatalities)
\]</span></p>
<p>where <span class="math inline">\(\mathrm{Y} = \sum_c T_{c,d}^j\)</span> denotes the <span class="math inline">\((J \times D)\)</span> left half of <span class="math inline">\(\mathrm{U}\)</span>.</p>
</div>
<div class="section level2">
<h2 id="connection-with-dtp">Connection with DTP<a class="anchor" aria-label="anchor" href="#connection-with-dtp"></a>
</h2>
<p>Dose transition pathways (DTP) seem to have been introduced primarily as a means to reconcile model-based formulations of dose-escalation trials with the habitually rule-based thinking of clinicians. Specifically, <span class="citation">Yap et al. (2017)</span> cites 3 specific “perceived challenges” in making the transition from rule-based to model-based designs:</p>
<ol style="list-style-type: decimal">
<li>The “flexibility” of model-based designs (which I take to mean the additional free parameters they introduce into the design space) creates choices which cannot readily be appreciated in the rule-based terms familiar to clinical investigators.</li>
<li>Benefits of model-based designs are likewise not apparent to clinical investigators, against the background of “rule-based designs perceived to be ‘successful’ for decades”.</li>
<li>From the trialist’s perspective, the ‘black-box’ recommendations of model-based designs “contrast unfavorably with the transparent, simple rules of a rule-based design.”</li>
</ol>
<p>To meet these challenges, DTP effectively transforms a model-based design into a rule-based design <em>locally</em> — so that its immediate operation several steps ahead can be ‘eyeballed’ by trialists as a small set of (say, <span class="math inline">\(4^4 = 64\)</span>) distinct paths. The exhaustive enumeration employed here as in <span class="citation">Norris (2020b)</span> differs conceptually in its <em>global</em> reach (reflected in the ‘CPE’ moniker), and in its intent to support <em>computation</em> over the paths as opposed to cursory inspection. Supporting this expansive concept has required significant programming effort; the implementation of CPE in package <code>precautionary</code> is hundreds of times faster than the DTP of package <code>dtpcrm</code> <span class="citation">(Yap et al. 2019)</span> on the VIOLA trial example below.</p>
</div>
<div class="section level2">
<h2 id="an-application">An application<a class="anchor" aria-label="anchor" href="#an-application"></a>
</h2>
<p>We will adopt the same parameters as in the <code>dtpcrm</code> <a href="https://cran.r-project.org/package=dtpcrm/vignettes/dtpcrm_vignettev02.html" class="external-link">package vignette</a>:<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="section level3">
<h3 id="viola-set-up">VIOLA set-up<a class="anchor" aria-label="anchor" href="#viola-set-up"></a>
</h3>
<div class="section level4">
<h4 id="clinical-parameters">Clinical parameters<a class="anchor" aria-label="anchor" href="#clinical-parameters"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">number.doses</span> <span class="op">&lt;-</span> <span class="fl">7</span>
<span class="va">start.dose.level</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">max.sample.size</span> <span class="op">&lt;-</span> <span class="fl">21</span>
<span class="va">target.DLT</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">cohort.size</span> <span class="op">&lt;-</span> <span class="fl">3</span></code></pre></div>
<p>Note that the sample size limit allows us to set <span class="math inline">\(C=7\)</span>.</p>
</div>
<div class="section level4">
<h4 id="model-specification-parameters">Model specification parameters<a class="anchor" aria-label="anchor" href="#model-specification-parameters"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prior.DLT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.07</span>, <span class="fl">0.12</span>, <span class="fl">0.20</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.52</span><span class="op">)</span>
<span class="va">prior.var</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="early-stopping">Early stopping<a class="anchor" aria-label="anchor" href="#early-stopping"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stop_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stop_for_excess_toxicity_empiric.html">stop_for_excess_toxicity_empiric</a></span><span class="op">(</span><span class="va">x</span>,
                                        tox_lim <span class="op">=</span> <span class="va">target.DLT</span> <span class="op">+</span> <span class="fl">0.1</span>,
                                        prob_cert <span class="op">=</span> <span class="fl">0.72</span>,
                                        dose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">stop</span><span class="op">)</span><span class="op">{</span>
    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">y</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">dtpcrm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dtpcrm/man/stop_for_consensus_reached.html" class="external-link">stop_for_consensus_reached</a></span><span class="op">(</span><span class="va">x</span>, req_at_mtd <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="complete-path-enumeration-cpe">Complete Path Enumeration (CPE)<a class="anchor" aria-label="anchor" href="#complete-path-enumeration-cpe"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">crm</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Crm-class.html">Crm</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">prior.DLT</span>,
               scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">prior.var</span><span class="op">)</span>,
               target <span class="op">=</span> <span class="va">target.DLT</span><span class="op">)</span><span class="op">$</span>
  <span class="fu">stop_func</span><span class="op">(</span><span class="va">stop_func</span><span class="op">)</span><span class="op">$</span>
  <span class="fu">no_skip_esc</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span>
  <span class="fu">no_skip_deesc</span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span>
  <span class="fu">global_coherent_esc</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>


<span class="va">crm</span><span class="op">$</span><span class="fu">trace_paths</span><span class="op">(</span>
      root_dose <span class="op">=</span> <span class="va">start.dose.level</span>,
      cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Registered S3 method overwritten by 'dtpcrm':</span>
<span class="co">##   method    from </span>
<span class="co">##   print.mtd dfcrm</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">t0</span> <span class="co"># ~3sec on a 2.6GHz Quad Core i7; was ~17min with dtpcrm v0.1.1</span></code></pre></div>
<pre><code><span class="co">##    user  system elapsed </span>
<span class="co">##   2.985   0.400   2.011</span></code></pre>
<p>This yields all elements of the matrix formalism laid out in equations @ref(eq:pi)–@ref(eq:fatalities) above:<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">crm</span><span class="op">$</span><span class="fu">path_array</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## T (4693×7×7) constructed in 0.352 sec</span>
<span class="co">## T condensed in 0.353 sec</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4693    4    7</span></code></pre>
</div>
<div class="section level3">
<h3 id="compute-mathbfb-sum_c-n-choose-t_cd">Compute <span class="math inline">\(\mathbf{b} = \sum_c {n \choose T_{c,d}}\)</span><a class="anchor" aria-label="anchor" href="#compute-mathbfb-sum_c-n-choose-t_cd"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">3</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4693</span></code></pre>
</div>
<div class="section level3">
<h3 id="compute-mathrmu-and-mathrmy">Compute <span class="math inline">\(\mathrm{U}\)</span> and <span class="math inline">\(\mathrm{Y}\)</span><a class="anchor" aria-label="anchor" href="#compute-mathrmu-and-mathrmy"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="cn">T</span>, MARGIN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fl">3</span><span class="op">-</span><span class="cn">T</span>, MARGIN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Z</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4693   14</span></code></pre>
</div>
<div class="section level3">
<h3 id="derive-mathbfpi-from-the-crm-skeleton-to-check-that-sum_j-pij-equiv-1">Derive <span class="math inline">\(\mathbf{\pi}\)</span> from the CRM skeleton, to check that <span class="math inline">\(\sum_j \pi^j \equiv 1\)</span><a class="anchor" aria-label="anchor" href="#derive-mathbfpi-from-the-crm-skeleton-to-check-that-sum_j-pij-equiv-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">log_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">prior.DLT</span><span class="op">)</span>
<span class="va">log_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prior.DLT</span><span class="op">)</span>
<span class="va">log_pi</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">+</span> <span class="va">U</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">log_p</span>, <span class="va">log_q</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_pi</span><span class="op">)</span><span class="op">)</span> <span class="co"># check probabilities sum to 1</span></code></pre></div>
<pre><code><span class="co">## [1] 1</span></code></pre>
</div>
<div class="section level3">
<h3 id="comparison-with-the-dtp-formulation">Comparison with the DTP formulation<a class="anchor" aria-label="anchor" href="#comparison-with-the-dtp-formulation"></a>
</h3>
<p>With each of (up to) 7 cohorts having 4 possible outcomes (0, 1, 2 or 3 toxicities), the DTP tabulation of <code>dtpcrm</code> lists a total of <span class="math inline">\(4^7 = 16384\)</span> paths. These are not all distinct paths, however, since early stopping results in path degeneracy.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> For example, we can see that paths 1005–1008 all terminate at the 6th cohort, resulting in a <span class="math inline">\(4\times\)</span> degeneracy:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">viola_dtp</span><span class="op">)</span> <span class="co"># as originally generated by 'dtpcrm:calculate_dtps'</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">viola_dtp</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1010</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
D0
</th>
<th style="text-align:right;">
T1
</th>
<th style="text-align:right;">
D1
</th>
<th style="text-align:right;">
T2
</th>
<th style="text-align:right;">
D2
</th>
<th style="text-align:right;">
T3
</th>
<th style="text-align:right;">
D3
</th>
<th style="text-align:right;">
T4
</th>
<th style="text-align:right;">
D4
</th>
<th style="text-align:right;">
T5
</th>
<th style="text-align:right;">
D5
</th>
<th style="text-align:right;">
T6
</th>
<th style="text-align:right;">
D6
</th>
<th style="text-align:right;">
T7
</th>
<th style="text-align:right;">
D7
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1001
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1002
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1003
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1004
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1005
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1006
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1007
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1008
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1009
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1010
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Paths terminating at the 5th cohort would be listed 16 times, and those terminating at the 4th cohort 64 times, etc. The net degeneracy indeed proves to be quite substantial, inflating the DTP table by a factor of <code>3.5</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">viola_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">viola_dtp</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">viola_paths</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4693   15</span></code></pre>
<p>To distinguish it from the degenerate DTP table returned by <code><a href="https://rdrr.io/pkg/dtpcrm/man/calculate_dtps.html" class="external-link">dtpcrm::calculate_dtps</a></code>, we will refer to the unique listing as the <em>path matrix</em>. Note that in <code>precautionary</code> this is available straightaway from the <code>Crm</code> object <code>crm</code> after having invoked <code>$trace_paths</code> on it above:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pmx</span> <span class="op">&lt;-</span> <span class="va">crm</span><span class="op">$</span><span class="fu">path_matrix</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pmx</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4693   15</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="fitting-a-lognormal-mathrmmtd_i-to-violas-crm-skeleton">Fitting a lognormal <span class="math inline">\(\mathrm{MTD}_i\)</span> to VIOLA’s CRM skeleton<a class="anchor" aria-label="anchor" href="#fitting-a-lognormal-mathrmmtd_i-to-violas-crm-skeleton"></a>
</h2>
<p>Whereas the analysis of <span class="citation">Norris (2020b)</span> was carried forth under a thoroughly logarithmic scaling of <em>dose</em>, the dosing intervals employed in the VIOLA trial are suggestive of an approximately square-root dose scaling—at least for the nonzero doses:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">viola_dosing</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Label <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span> <span class="co"># VIOLA dose designations -2,...,4</span>
            ,Level <span class="op">=</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>  <span class="co"># We use integer dose indexes here</span>
            ,Dose_mg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">35</span><span class="op">)</span>
            ,skeleton <span class="op">=</span> <span class="va">prior.DLT</span>
             <span class="op">)</span>
<span class="va">viola_dosing</span> <span class="op">&lt;-</span> <span class="va">viola_dosing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>log_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Dose_mg</span><span class="op">)</span>
        ,sqrt_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Dose_mg</span><span class="op">)</span>
        <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Level</span> <span class="op">~</span> <span class="va">sqrt_dose</span>, data <span class="op">=</span> <span class="va">viola_dosing</span>, type <span class="op">=</span> <span class="st">'b'</span>
     , ylab <span class="op">=</span> <span class="st">"Dose Level"</span>
     , xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">[</span><span class="va">mg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
     , las <span class="op">=</span> <span class="fl">1</span>
     <span class="op">)</span></code></pre></div>
<p><img src="Safety-Schematic-via-CPE_files/figure-html/VIOLA-dose-scaling-1.png" width="576"></p>
<p>Indeed, the CRM skeleton looks quite close to a normal distribution under this scaling:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">skeleton</span> <span class="op">~</span> <span class="va">sqrt_dose</span>, data <span class="op">=</span> <span class="va">viola_dosing</span>
     , type <span class="op">=</span> <span class="st">'b'</span>
     , xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">[</span><span class="va">mg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
     , ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.55</span><span class="op">)</span>
     , las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Safety-Schematic-via-CPE_files/figure-html/skeleton-as-expectation-1.png" alt="CRM skeleton probabilities vs $\sqrt{\mathrm{Dose}}$, with superimposed normal distribution having median $\sqrt{33}$ and standard deviation 3." width="576"><p class="caption">
CRM skeleton probabilities vs <span class="math inline">\(\sqrt{\mathrm{Dose}}\)</span>, with superimposed normal distribution having median <span class="math inline">\(\sqrt{33}\)</span> and standard deviation 3.
</p>
</div>
<p>Nevertheless, the treatment of zero dose under this scaling is pharmacologically problematic, if not outright homeopathic, so we will proceed instead using a lognormal <span class="math inline">\(\mathrm{MTD}_i\)</span> distribution fitted to the CRM skeleton.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">skeleton</span> <span class="op">~</span> <span class="va">log_dose</span>, data <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">viola_dosing</span>, <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">log_dose</span><span class="op">)</span><span class="op">)</span>
     , type <span class="op">=</span> <span class="st">'b'</span>
     , xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">[</span><span class="va">mg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
     , xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3.6</span><span class="op">)</span>
     , ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.55</span><span class="op">)</span>
     , las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">sse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu_sigma</span>, <span class="va">dose</span> <span class="op">=</span> <span class="va">viola_dosing</span><span class="op">$</span><span class="va">Dose_mg</span><span class="op">)</span><span class="op">{</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">mu_sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="va">mu_sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">lnorm.DLT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">dose</span>, meanlog <span class="op">=</span> <span class="va">mu</span>, sdlog <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
  <span class="va">sse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">lnorm.DLT</span> <span class="op">-</span> <span class="va">prior.DLT</span><span class="op">)</span><span class="op">[</span><span class="va">dose</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">38</span><span class="op">)</span>, sigma<span class="op">=</span><span class="fl">1.8</span><span class="op">)</span>, fn <span class="op">=</span> <span class="va">sse</span><span class="op">)</span>
<span class="va">mu_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="st">'mu'</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">sigma_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="st">'sigma'</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3.55</span>, <span class="fl">0.05</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="va">mu_opt</span>, sdlog <span class="op">=</span> <span class="va">sigma_opt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Safety-Schematic-via-CPE_files/figure-html/skeleton-log-match-1.png" alt="CRM skeleton probabilities vs $\log \mathrm{Dose}$, with superimposed lognormal distribution having median $\mu = 35$mg and $\sigma = 1.6$." width="576"><p class="caption">
CRM skeleton probabilities vs <span class="math inline">\(\log \mathrm{Dose}\)</span>, with superimposed lognormal distribution having median <span class="math inline">\(\mu = 35\)</span>mg and <span class="math inline">\(\sigma = 1.6\)</span>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="viola-safety">VIOLA safety<a class="anchor" aria-label="anchor" href="#viola-safety"></a>
</h2>
<p>Taking this CRM skeleton fit as a modal expectation of the <span class="math inline">\(\mathrm{MTD}_i\)</span> distribution, we may employ Equations @ref(eq:fatal-fraction)–@ref(eq:fatalities) to obtain an expected number of fatal toxicities, as a function of <span class="math inline">\(\kappa\)</span>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kappa</span>, <span class="va">mu</span><span class="op">=</span><span class="va">mu_opt</span>, <span class="va">sigma</span><span class="op">=</span><span class="va">sigma_opt</span>, <span class="va">X</span><span class="op">=</span><span class="va">viola_dosing</span><span class="op">$</span><span class="va">Dose_mg</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># For ease of use, this function is VECTORIZED over kappa,</span>
  <span class="co"># generally returning a length(X) x length(kappa) MATRIX</span>
  <span class="co"># which can validly right-multiply Y in t(pi) %*% Y %*% f.</span>
  <span class="co"># (In the special case length(kappa)==1, a vector is returned.)</span>
  <span class="va">gr5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="va">mu</span>, sdlog <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
  <span class="va">dlt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">*</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span>, meanlog <span class="op">=</span> <span class="va">mu</span>, sdlog <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
  <span class="va">ff</span> <span class="op">&lt;-</span> <span class="va">gr5</span><span class="op">/</span><span class="va">dlt</span>
  <span class="va">ff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># replace NaN caused by X[1]==0</span>
  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,
    kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">kappa</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span><span class="op">)</span>
  <span class="va">ff</span>
<span class="op">}</span>

<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1.2</span>, <span class="fl">0.02</span><span class="op">)</span>
<span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span>kappa <span class="op">=</span> <span class="va">kappa</span><span class="op">)</span>
<span class="va">Ef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_pi</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="cn">F</span>
<span class="va">Ef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Ef</span><span class="op">)</span> <span class="co"># transpose to a column-vector</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Ef</span> <span class="op">~</span> <span class="va">kappa</span>, type <span class="op">=</span> <span class="st">'l'</span>
     , xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span>
     , ylab <span class="op">=</span> <span class="st">"Expected Number of Fatal DLTs"</span>
     , las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Safety-Schematic-via-CPE_files/figure-html/fatalities-vs-kappa-1.png" width="576"></p>
<div class="section level3">
<h3 id="beyond-the-skeleton">Beyond the skeleton<a class="anchor" aria-label="anchor" href="#beyond-the-skeleton"></a>
</h3>
<p>The development of CRM methods has left the status of the <em>skeleton</em> somewhat ambiguous. While evading its realistic interpretation as an <span class="math inline">\(\mathrm{MTD}_i\)</span> distribution,<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> CRM proponents often fixate on the skeleton as a natural starting point for simulation studies. <span class="citation">Braun (2020)</span>, for example, develops an approach which “hinges on the assumption that the true DLT probabilities examined are consistent with the selected skeleton.”</p>
<p>Nevertheless, it is incumbent on trial methodologists to examine the safety characteristics of their designs under conditions of model misspecification. The technique of Figure 3 in <span class="citation">Norris (2020b)</span> provides one approach.</p>
<p>To enable parameter departures from our lognormal skeleton fit, we require <span class="math inline">\(\log \boldsymbol{\pi}\)</span> as a <em>function</em> of <span class="math inline">\((\mu, \sigma)\)</span>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">log_pi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">viola_dosing</span><span class="op">$</span><span class="va">Dose_mg</span>, meanlog <span class="op">=</span> <span class="va">mu</span>, sdlog <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
  <span class="va">log_pq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>
  <span class="va">log_pi</span> <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="va">U</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">log_pq</span>, <span class="op">-</span><span class="fl">500</span><span class="op">)</span> <span class="co"># clamping -Inf to -500 avoids NaN's  </span>
<span class="op">}</span></code></pre></div>
<p>This enables us to compute expected fatalities as a scalar field on a 3-dimensional space defined by parameters <span class="math inline">\((\mu, \sigma, \kappa)\)</span>. But again as in <span class="citation">Norris (2020b)</span> we employ a minimax framing of our safety question, to achieve a dimension reduction:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu_minimax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">viola_dosing</span><span class="op">$</span><span class="va">Dose_mg</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co"># dose 3 is 2nd-highest *nonzero* dose</span></code></pre></div>
<p>The irregularly spaced doses of VIOLA don’t yield a unique delta, but the <span class="math inline">\(2\times\)</span> multipliers either side of dose level 3 (our <code>mu_minimax</code>) allow us to select <span class="math inline">\(\delta = \log 2\)</span> as a local approximation:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">viola_dosing</span><span class="op">$</span><span class="va">Dose_mg</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We may now generate a grid of values, and plot contours:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">focustab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/J.html" class="external-link">CJ</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu_minimax</span>
              , K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.65</span> , <span class="fl">0.01</span><span class="op">)</span> <span class="co"># K = kappa / sigma</span>
              , sigma <span class="op">=</span> <span class="va">delta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">2.2</span>, <span class="fl">0.01</span><span class="op">)</span>
              <span class="op">)</span>
<span class="va">focustab</span><span class="op">[</span>, <span class="va">kappa</span> <span class="op">:=</span> <span class="va">K</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">]</span>
<span class="va">focustab</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">log_pi</span><span class="op">(</span><span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>
             <span class="va">Y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">f</span><span class="op">(</span>kappa<span class="op">=</span><span class="va">kappa</span>, mu<span class="op">=</span><span class="va">mu</span>, sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>
       , by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="figure">
<img src="Safety-Schematic-via-CPE_files/figure-html/contourplot-1.png" alt="Ex ante expectation of fatalities in the VIOLA trial, under the analytical set-up of Figure 3 in @norris_what_2020. Therapeutic index $\kappa/\sigma$ gauges the target drug's aptness for safe-and-effective 1-size-fits-all dosing in the trial's combination regimen. Signal-to-noise index $\delta/\sigma$ governs the informativeness of the dose-escalation process. This analysis assumes a log-normally distributed $\MTDi$, with median parameter set (on minimax grounds) at VIOLA dose level 3. Plotted values of $\delta/\sigma$ are based on $\delta=\log(2)$, selected according to the $2\times$ VIOLA dose-level spacing around this dose level." width="576"><p class="caption">
Ex ante expectation of fatalities in the VIOLA trial, under the analytical set-up of Figure 3 in <span class="citation">Norris (2020b)</span>. Therapeutic index <span class="math inline">\(\kappa/\sigma\)</span> gauges the target drug’s aptness for safe-and-effective 1-size-fits-all dosing in the trial’s combination regimen. Signal-to-noise index <span class="math inline">\(\delta/\sigma\)</span> governs the informativeness of the dose-escalation process. This analysis assumes a log-normally distributed <span class="math inline">\(\mathrm{MTD}_i\)</span>, with median parameter set (on minimax grounds) at VIOLA dose level 3. Plotted values of <span class="math inline">\(\delta/\sigma\)</span> are based on <span class="math inline">\(\delta=\log(2)\)</span>, selected according to the <span class="math inline">\(2\times\)</span> VIOLA dose-level spacing around this dose level.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Although initially put forward with different intent, the <em>dose transition pathways</em> of <span class="citation">Yap et al. (2017)</span> render the enumerative approach of <span class="citation">Norris (2020b)</span> immediately applicable to the CRM. Importantly, the analysis is found to be computationally feasible in the setting of an actual trial. Indeed, with performance improvements debuted in version 0.2-2 of <code>precautionary</code>, the complete VIOLA enumeration becomes essentially trivial, taking just a few seconds on modern desktop hardware. This raises the prospect of scaling up our problems to meet the opportunities of massive parallelism <span class="citation">(Gustafson 1988)</span>, expanding this mode of analysis to ever larger dose-finding trials.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<p>The approach taken here exemplifies a widely applicable scheme for the safety analysis of dose-escalation trials generally, rooted in the exhaustive enumeration of all possible trial paths.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-braun_simulationfree_2020">
<p>Braun, Thomas M. 2020. “A Simulation‐free Approach to Assessing the Performance of the Continual Reassessment Method.” <em>Statistics in Medicine</em>, September, sim.8746. <a href="https://doi.org/10.1002/sim.8746" class="external-link">https://doi.org/10.1002/sim.8746</a>.</p>
</div>
<div id="ref-craddock_combination_2019">
<p>Craddock, Charles, Daniel Slade, Carmela De Santo, Rachel Wheat, Paul Ferguson, Andrea Hodgkinson, Kristian Brock, et al. 2019. “Combination Lenalidomide and Azacitidine: A Novel Salvage Therapy in Patients Who Relapse After Allogeneic Stem-Cell Transplantation for Acute Myeloid Leukemia.” <em>Journal of Clinical Oncology: Official Journal of the American Society of Clinical Oncology</em>, January, JCO1800889. <a href="https://doi.org/10.1200/JCO.18.00889" class="external-link">https://doi.org/10.1200/JCO.18.00889</a>.</p>
</div>
<div id="ref-gustafson_reevaluating_1988">
<p>Gustafson, John L. 1988. “Reevaluating Amdahl’s Law.” <em>Communications of the ACM</em> 31: 532–33.</p>
</div>
<div id="ref-norris_comment_2020">
<p>Norris, David C. 2020a. “Comment on Wages et Al, Coherence Principles in Interval-Based Dose Finding. Pharmaceutical Statistics 2019, Doi:10.1002/Pst.1974.” <em>Pharmaceutical Statistics</em>, March. <a href="https://doi.org/10.1002/pst.2016" class="external-link">https://doi.org/10.1002/pst.2016</a>.</p>
</div>
<div id="ref-norris_what_2020">
<p>———. 2020b. “What Were They Thinking? Pharmacologic Priors Implicit in a Choice of 3+3 Dose-Escalation Design.” <em>arXiv:2012.05301 [stat.ME]</em>, December. <a href="https://arxiv.org/abs/2012.05301" class="external-link">https://arxiv.org/abs/2012.05301</a>.</p>
</div>
<div id="ref-yap_dose_2017">
<p>Yap, Christina, Lucinda J. Billingham, Ying Kuen Cheung, Charlie Craddock, and John O’Quigley. 2017. “Dose Transition Pathways: The Missing Link Between Complex Dose-Finding Designs and Simple Decision-Making.” <em>Clinical Cancer Research: An Official Journal of the American Association for Cancer Research</em> 23 (24): 7440–7. <a href="https://doi.org/10.1158/1078-0432.CCR-17-0582" class="external-link">https://doi.org/10.1158/1078-0432.CCR-17-0582</a>.</p>
</div>
<div id="ref-R-dtpcrm">
<p>Yap, Christina, Daniel Slade, Kristian Brock, and Yi Pan. 2019. <em>Dtpcrm: Dose Transition Pathways for Continual Reassessment Method</em>. <a href="https://CRAN.R-project.org/package=dtpcrm" class="external-link">https://CRAN.R-project.org/package=dtpcrm</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>To see this, consider that one may ‘read’ such a matrix, starting from the (deterministic) starting dose, and applying the (deterministic) design rules at each step. That is, a deterministic design <em>by definition</em> imposes a unique sequence on the entries in such a matrix.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Products or sums over <span class="math inline">\(c\)</span> or pairs <span class="math inline">\((c,d)\)</span> are understood to be taken over the <em>non-empty</em> cohorts thus indexed. In R, this convention is easily applied by using <code>NA</code> to represent ‘<span class="math inline">\(-\)</span>’ , and performing aggregate operations with option <code>na.rm=TRUE</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>See Table 1 in <span class="citation">Craddock et al. (2019)</span>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Those interested in implementation details may examine the abstract R6 superclass <code>Cpe</code> from which class <code>Crm</code> is derived.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Indeed, the underlying calculations exhibit an even more remarkable degree of degeneracy, which is exploited through memoization implemented in R6 class <code>Crm</code> of <code>precautionary</code>.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>For a related perspective on interpretational issues, see <span class="citation">Norris (2020a)</span>.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>See also <a href="https://en.wikipedia.org/wiki/Gustafson%27s_law" class="external-link uri">https://en.wikipedia.org/wiki/Gustafson%27s_law</a>.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David C. Norris.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
